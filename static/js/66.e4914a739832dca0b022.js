webpackJsonp([66],{HVFi:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Dd8w"),i=s.n(a),r=s("NYxO"),n=s("vLgD");function l(e){return Object(n.a)({url:"http://127.0.0.1:8000/polls/chat/messages",method:"get",params:e})}var d={name:"chat",computed:i()({},Object(r.b)(["id","first_name","avatar"])),created:function(){this.getList(),this.getMessagesList()},data:function(){return{messages:[],alist:[],list:[],newMessage:"",queryData:{senderId:this.id},queryDataMessages:{senderId:this.id,receiverId:this.id},user:{id:"",first_name:"",last_name:"",avatar:""},activeIndex:0,filter:null}},methods:{handleSend:function(){var e,t=this;(e={senderId:this.id,receiverId:this.user.id,message:this.newMessage},Object(n.a)({url:"http://127.0.0.1:8000/polls/chat/send",method:"post",data:e})).then(function(e){t.messages.push(JSON.parse(e.data.message)[0]),t.newMessage=""})},getMessagesList:function(e,t){var s=this;t.userId!==this.user.id&&(this.user.id=t.userId,this.user.first_name=t.user_first_name,this.user.last_name=t.user_last_name,this.user.avatar=t.userAvatar,this.activeIndex=e,l({id:this.id,userId:this.user.id}).then(function(e){s.messages=JSON.parse(e.data.messages)}))},getList:function(){var e=this;l({id:this.id}).then(function(t){e.list=JSON.parse(t.data.list),e.alist=e.list})},handleFilter:function(){var e=this;console.log(this.filter),this.list=this.alist.filter(function(t){return-1!==t.user_first_name.indexOf(e.filter)})}}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"frame"}},[s("div",{attrs:{id:"sidepanel"}},[s("div",{attrs:{id:"search"}},[e._m(0),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],attrs:{type:"text",placeholder:"Search contacts..."},domProps:{value:e.filter},on:{keyup:e.handleFilter,input:function(t){t.target.composing||(e.filter=t.target.value)}}})]),e._v(" "),s("div",{attrs:{id:"contacts"}},[s("ul",e._l(e.list,function(t,a){return s("li",{key:a,staticClass:"contact ",class:{active:a===e.activeIndex},on:{click:function(s){e.getMessagesList(a,t)}}},[s("div",{staticClass:"wrap"},[s("span",{staticClass:"contact-status busy"}),e._v(" "),s("img",{attrs:{src:t.userAvatar,alt:""}}),e._v(" "),s("div",{staticClass:"meta"},[s("p",{staticClass:"name"},[e._v(e._s(t.user_first_name)+" "+e._s(t.user_last_name))]),e._v(" "),s("p",{staticClass:"preview"},[e._v(e._s(t.message))])])])])}))]),e._v(" "),s("div",{attrs:{id:"bottom-bar"}})]),e._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"contact-profile"},[s("img",{attrs:{src:e.user.avatar,alt:""}}),e._v(" "),s("p",[e._v(e._s(e.user.first_name)+" "+e._s(e.user.last_name))])]),e._v(" "),s("div",{staticClass:"messages"},[s("ul",e._l(e.messages,function(t,a){return s("li",{key:a,class:{replies:t.senderId===e.id,sent:t.senderId!==e.id}},[s("img",{attrs:{src:t.senderId===e.id?e.avatar:e.user.avatar,alt:""}}),e._v(" "),s("p",[e._v(e._s(t.message))])])}))]),e._v(" "),s("div",{staticClass:"message-input"},[s("div",{staticClass:"wrap"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.newMessage,expression:"newMessage"}],attrs:{type:"text",placeholder:"Write your message..."},domProps:{value:e.newMessage},on:{input:function(t){t.target.composing||(e.newMessage=t.target.value)}}}),e._v(" "),s("el-button",{staticClass:"submit",nativeOn:{click:function(t){t.preventDefault(),e.handleSend(t)}}},[s("i",{staticClass:"fa fa-paper-plane",attrs:{"aria-hidden":"true"}})])],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("label",{attrs:{for:""}},[t("i",{staticClass:"fa fa-search",attrs:{"aria-hidden":"true"}})])}]},u=s("VU/8")(d,c,!1,null,null,null);t.default=u.exports}});