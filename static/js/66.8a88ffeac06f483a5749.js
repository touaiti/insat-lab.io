webpackJsonp([66],{HVFi:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=t("Dd8w"),i=t.n(a),r=t("NYxO"),n=t("vLgD");function l(e){return Object(n.a)({url:"https://sheltered-ravine-52326.herokuapp.com/polls/chat/messages",method:"get",params:e})}var d={name:"chat",computed:i()({},Object(r.b)(["id","first_name","avatar"])),created:function(){this.getList(),this.getMessagesList()},data:function(){return{messages:[],alist:[],list:[],newMessage:"",queryData:{senderId:this.id},queryDataMessages:{senderId:this.id,receiverId:this.id},user:{id:"",first_name:"",last_name:"",avatar:""},activeIndex:0,filter:null}},methods:{handleSend:function(){var e,s=this;(e={senderId:this.id,receiverId:this.user.id,message:this.newMessage},Object(n.a)({url:"https://sheltered-ravine-52326.herokuapp.com/polls/chat/send",method:"post",data:e})).then(function(e){s.messages.push(JSON.parse(e.data.message)[0]),s.newMessage=""})},getMessagesList:function(e,s){var t=this;s.userId!==this.user.id&&(this.user.id=s.userId,this.user.first_name=s.user_first_name,this.user.last_name=s.user_last_name,this.user.avatar=s.userAvatar,this.activeIndex=e,l({id:this.id,userId:this.user.id}).then(function(e){t.messages=JSON.parse(e.data.messages)}))},getList:function(){var e=this;l({id:this.id}).then(function(s){e.list=JSON.parse(s.data.list),e.alist=e.list})},handleFilter:function(){var e=this;console.log(this.filter),this.list=this.alist.filter(function(s){return-1!==s.user_first_name.indexOf(e.filter)})}}},c={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{attrs:{id:"frame"}},[t("div",{attrs:{id:"sidepanel"}},[t("div",{attrs:{id:"search"}},[e._m(0),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.filter,expression:"filter"}],attrs:{type:"text",placeholder:"Search contacts..."},domProps:{value:e.filter},on:{keyup:e.handleFilter,input:function(s){s.target.composing||(e.filter=s.target.value)}}})]),e._v(" "),t("div",{attrs:{id:"contacts"}},[t("ul",e._l(e.list,function(s,a){return t("li",{key:a,staticClass:"contact ",class:{active:a===e.activeIndex},on:{click:function(t){e.getMessagesList(a,s)}}},[t("div",{staticClass:"wrap"},[t("span",{staticClass:"contact-status busy"}),e._v(" "),t("img",{attrs:{src:s.userAvatar,alt:""}}),e._v(" "),t("div",{staticClass:"meta"},[t("p",{staticClass:"name"},[e._v(e._s(s.user_first_name)+" "+e._s(s.user_last_name))]),e._v(" "),t("p",{staticClass:"preview"},[e._v(e._s(s.message))])])])])}))]),e._v(" "),t("div",{attrs:{id:"bottom-bar"}})]),e._v(" "),t("div",{staticClass:"content"},[t("div",{staticClass:"contact-profile"},[t("img",{attrs:{src:e.user.avatar,alt:""}}),e._v(" "),t("p",[e._v(e._s(e.user.first_name)+" "+e._s(e.user.last_name))])]),e._v(" "),t("div",{staticClass:"messages"},[t("ul",e._l(e.messages,function(s,a){return t("li",{key:a,class:{replies:s.senderId===e.id,sent:s.senderId!==e.id}},[t("img",{attrs:{src:s.senderId===e.id?e.avatar:e.user.avatar,alt:""}}),e._v(" "),t("p",[e._v(e._s(s.message))])])}))]),e._v(" "),t("div",{staticClass:"message-input"},[t("div",{staticClass:"wrap"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.newMessage,expression:"newMessage"}],attrs:{type:"text",placeholder:"Write your message..."},domProps:{value:e.newMessage},on:{input:function(s){s.target.composing||(e.newMessage=s.target.value)}}}),e._v(" "),t("el-button",{staticClass:"submit",nativeOn:{click:function(s){s.preventDefault(),e.handleSend(s)}}},[t("i",{staticClass:"fa fa-paper-plane",attrs:{"aria-hidden":"true"}})])],1)])])])},staticRenderFns:[function(){var e=this.$createElement,s=this._self._c||e;return s("label",{attrs:{for:""}},[s("i",{staticClass:"fa fa-search",attrs:{"aria-hidden":"true"}})])}]},u=t("VU/8")(d,c,!1,null,null,null);s.default=u.exports}});